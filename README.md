# RTSP to WebRTC Viewer

–ü—Ä–æ–µ–∫—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ RTSP –ø–æ—Ç–æ–∫–æ–≤ —á–µ—Ä–µ–∑ WebRTC –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π TURN —Å–µ—Ä–≤–µ—Ä–∞.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è RTSP –ø–æ—Ç–æ–∫–æ–≤ –≤ WebRTC
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π TURN —Å–µ—Ä–≤–µ—Ä (Coturn) –¥–ª—è —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ NAT
- ‚úÖ –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π Angular –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ Docker Compose –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- ‚úÖ Go2RTC –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–≤

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose
- RTSP –∫–∞–º–µ—Ä–∞ –∏–ª–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–æ—Ç–æ–∫–∞
- Node.js 18+ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Angular –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
rtsp-webrtc-viewer/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ go2rtc/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ go2rtc.yaml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Go2RTC
‚îÇ   ‚îú‚îÄ‚îÄ coturn/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ turnserver.conf      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Coturn TURN —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ nginx/
‚îÇ       ‚îî‚îÄ‚îÄ nginx.conf           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx
‚îú‚îÄ‚îÄ frontend/                    # Angular –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ video-player/  # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–∏–¥–µ–æ–ø–ª–µ–µ—Ä–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ webrtc.ts      # WebRTC —Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ README.md
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ RTSP –∏—Å—Ç–æ—á–Ω–∏–∫–∞

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `config/go2rtc/go2rtc.yaml`:

```yaml
streams:
  camera1:
    - rtsp://admin:password@192.168.1.100:554/stream1
```

–ó–∞–º–µ–Ω–∏—Ç–µ URL –Ω–∞ –∞–¥—Ä–µ—Å –≤–∞—à–µ–π –∫–∞–º–µ—Ä—ã:
- `admin:password` - –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å –∫–∞–º–µ—Ä—ã
- `192.168.1.100` - IP –∞–¥—Ä–µ—Å –∫–∞–º–µ—Ä—ã
- `554` - –ø–æ—Ä—Ç RTSP (–æ–±—ã—á–Ω–æ 554)
- `/stream1` - –ø—É—Ç—å –∫ –ø–æ—Ç–æ–∫—É (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏ –∫–∞–º–µ—Ä—ã)

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ TURN —Å–µ—Ä–≤–µ—Ä–∞

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `config/coturn/turnserver.conf`:

```conf
# –ò–∑–º–µ–Ω–∏—Ç–µ –∫—Ä–µ–¥–µ–Ω—à–∏–∞–ª—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
user=turnuser:turnpassword

# –í–ê–ñ–ù–û: –£–∫–∞–∂–∏—Ç–µ –≤–∞—à –ø—É–±–ª–∏—á–Ω—ã–π IP –∞–¥—Ä–µ—Å
external-ip=YOUR_PUBLIC_IP
```

**–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```conf
external-ip=192.168.1.X  # –í–∞—à –ª–æ–∫–∞–ª—å–Ω—ã–π IP
allow-loopback-peers
```

**–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
- –ü–æ–ª—É—á–∏—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—É–±–ª–∏—á–Ω—ã–π IP
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç-—Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ:
  - UDP/TCP 3478 (STUN/TURN)
  - UDP 49152-49200 (TURN relay)
- –ó–∞–º–µ–Ω–∏—Ç–µ `YOUR_PUBLIC_IP` –Ω–∞ –≤–∞—à –ø—É–±–ª–∏—á–Ω—ã–π IP

### 3. –û–±–Ω–æ–≤–∏—Ç–µ TURN –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Angular

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `frontend/src/app/services/webrtc.ts`:

```typescript
private iceServers: RTCIceServer[] = [
  { urls: 'stun:stun.l.google.com:19302' },
  {
    urls: [
      'turn:YOUR_PUBLIC_IP:3478?transport=udp',
      'turn:YOUR_PUBLIC_IP:3478?transport=tcp'
    ],
    username: 'turnuser',
    credential: 'turnpassword'
  }
];
```

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –®–∞–≥ 1: –°–±–æ—Ä–∫–∞ Angular –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
cd frontend
npm install
npm run build
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –ø—Ä–æ–¥–∞–∫—à–Ω –±–∏–ª–¥ –≤ `frontend/dist/rtsp-webrtc-viewer/browser/`

### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
# –ò–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
docker-compose up -d
```

–ò–ª–∏ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤:

```bash
docker-compose up
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
docker-compose ps
```

–í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ "Up".

## üåê –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º

- **Angular UI**: http://localhost:8080
- **Go2RTC Web UI**: http://localhost:1984
- **TURN Server**: localhost:3478 (UDP/TCP)

## üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8080 –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"–ü–æ–¥–∫–ª—é—á–∏—Ç—å"**
3. –í–∏–¥–µ–æ –ø–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∞—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è

### –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å –¥—Ä—É–≥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–±—Ä–∞—Ç-—Å–∞–±—Å–∫—Ä–∞–π–±–µ—Ä):

1. –£–∑–Ω–∞–π—Ç–µ –≤–∞—à –ª–æ–∫–∞–ª—å–Ω—ã–π IP: `ip addr show` (Linux) –∏–ª–∏ `ipconfig` (Windows)
2. –û—Ç–∫—Ä–æ–π—Ç–µ `http://YOUR_LOCAL_IP:8080` –Ω–∞ –¥—Ä—É–≥–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
3. –ù–∞–∂–º–∏—Ç–µ **"–ü–æ–¥–∫–ª—é—á–∏—Ç—å"**

## üîß –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:

```bash
# –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose logs

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose logs go2rtc
docker-compose logs coturn
docker-compose logs nginx-frontend
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∫–∞–º–µ—Ä–µ:

–û—Ç–∫—Ä–æ–π—Ç–µ Go2RTC Web UI: http://localhost:1984

–ó–¥–µ—Å—å –≤—ã —É–≤–∏–¥–∏—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–æ—Ç–æ–∫–æ–≤ –∏ —Å–º–æ–∂–µ—Ç–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –Ω–∞–ø—Ä—è–º—É—é.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ WebRTC –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

–û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12) –≤ –±—Ä–∞—É–∑–µ—Ä–µ ‚Üí Console tab.
–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ª–æ–≥–∏:
```
Received remote track: video
ICE connection state: connected
Connection state: connected
WebRTC connection established
```

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

**1. –í–∏–¥–µ–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ RTSP URL –≤ `config/go2rtc/go2rtc.yaml`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Go2RTC: `docker-compose logs go2rtc`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–∞–º–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω–∞: `ffprobe rtsp://your-camera-url`

**2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ NAT:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ TURN —Å–µ—Ä–≤–µ—Ä–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `external-ip` —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç-—Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥ –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ

**3. Angular –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:**
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å–±–æ—Ä–∫–∞: `npm run build` –≤ –ø–∞–ø–∫–µ frontend
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç: `ls frontend/dist/rtsp-webrtc-viewer/browser/`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ nginx: `docker-compose logs nginx-frontend`

## üì± –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ó–∞–ø—É—Å–∫ Angular –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```bash
cd frontend
npm start
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ http://localhost:4200

–ù–µ –∑–∞–±—É–¥—å—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å `apiUrl` –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```typescript
<app-video-player
  streamName="camera1"
  apiUrl="http://localhost:1984"
></app-video-player>
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**

1. –°–º–µ–Ω–∏—Ç–µ –∫—Ä–µ–¥–µ–Ω—à–∏–∞–ª—ã TURN —Å–µ—Ä–≤–µ—Ä–∞ –≤ `turnserver.conf`
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS/TLS –¥–ª—è web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∞–π—Ä–≤–æ–ª–ª –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ authentication secret –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π –¥–ª—è TURN

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Go2RTC Documentation](https://github.com/AlexxIT/go2rtc)
- [Coturn Documentation](https://github.com/coturn/coturn)
- [Angular WebRTC](https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API)
- [TURN Server Guide](https://www.html5rocks.com/en/tutorials/webrtc/infrastructure/)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –õ–æ–≥–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
2. Developer Console –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–π—Ä–≤–æ–ª–ª–∞ –∏ —Ä–æ—É—Ç–µ—Ä–∞

---

**–ê–≤—Ç–æ—Ä:** Created with Claude Code
**–î–∞—Ç–∞:** 2025
